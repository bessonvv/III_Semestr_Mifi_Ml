# Прототип книжного рекомендательного сервиса

## Описание проекта

Этот проект представляет собой комплексную рекомендательную систему для подбора книг, построенную на основе датасета **Goodbooks-10k**. В рамках проекта реализованы и сравнены четыре различных подхода к построению рекомендательных систем.

## Структура проекта

```
DZ1/
├── goodbooks-10k/           # Датасет
│   ├── ratings.csv          # Оценки пользователей
│   ├── books.csv            # Информация о книгах
│   ├── tags.csv             # Теги
│   └── book_tags.csv        # Связь книг и тегов
├── book_recommender_system.ipynb  # Основной Jupyter Notebook
└── README.md                # Этот файл
```

## Реализованные модели

### 1. Popularity-Based (Неперсонализированная модель)
- **Описание**: Рекомендует самые популярные книги по среднему рейтингу
- **Преимущества**: Простота, быстрота, хорошо работает для новых пользователей
- **Недостатки**: Отсутствие персонализации, усиление смещения популярности

### 2. Content-Based (Контентная модель)
- **Описание**: TF-IDF векторизация названий и тегов книг с вычислением косинусной близости
- **Преимущества**: Не требует данных о других пользователях, решает проблему холодного старта для книг
- **Недостатки**: Ограниченная "сюрпризность", зависит от качества контентных данных

### 3. Item-Based Collaborative Filtering
- **Описание**: Предсказание на основе схожести между книгами по поведению пользователей
- **Преимущества**: Учитывает поведение пользователей, находит неочевидные связи
- **Недостатки**: Высокая вычислительная сложность O(n_items²), проблемы с разреженностью

### 4. Matrix Factorization (SVD)
- **Описание**: Разложение матрицы user-item на латентные факторы с помощью SVD
- **Преимущества**: Лучшее качество, масштабируемость, хорошо справляется с разреженностью
- **Недостатки**: Требует достаточно данных, проблемы с холодным стартом

### 5. Hybrid Model (Гибридная модель)
- **Описание**: Комбинирует все подходы в зависимости от контекста пользователя
- **Стратегия**:
  - Новые пользователи → Popularity-Based
  - Малоактивные пользователи → Content-Based
  - Активные пользователи → SVD

## Ключевые этапы работы

### Этап 1: EDA (Exploratory Data Analysis)
- Анализ распределения оценок
- Исследование активности пользователей
- Анализ популярности книг
- Изучение разреженности матрицы взаимодействий
- Визуализация тегов

### Этап 2: Выявленные проблемы данных
1. **Разреженность**: ~99.98% матрицы пустые
2. **Смещение популярности**: ярко выраженный "длинный хвост"
3. **Холодный старт**: значительная доля пользователей и книг с малым количеством взаимодействий
4. **Смещение в оценках**: пользователи склонны ставить высокие оценки (4-5)

### Этап 3: Оценка моделей
Все модели оцениваются с использованием метрик:
- **Precision@K**: доля релевантных среди рекомендованных
- **Recall@K**: доля найденных релевантных среди всех релевантных
- **nDCG@K**: нормализованный дисконтированный кумулятивный выигрыш (учитывает порядок)

## Установка и запуск

### Требования
```bash
pip install pandas numpy matplotlib seaborn scikit-learn scipy scikit-surprise
```

### Необходимые библиотеки
- `pandas` - работа с данными
- `numpy` - численные вычисления
- `matplotlib`, `seaborn` - визуализация
- `scikit-learn` - TF-IDF, метрики схожести
- `scipy` - разреженные матрицы
- `scikit-surprise` - алгоритмы рекомендаций (SVD)

### Запуск
1. Убедитесь, что датасет находится в папке `goodbooks-10k/`
2. Откройте `book_recommender_system.ipynb` в Jupyter Notebook или JupyterLab
3. Запустите все ячейки последовательно

## Результаты и выводы

### Лучшая модель
**SVD (Matrix Factorization)** показала наилучшие результаты по большинству метрик для активных пользователей благодаря способности:
- Выявлять латентные факторы предпочтений
- Обобщать паттерны поведения
- Справляться с разреженностью данных

### Однако...
Ни одна модель не является универсальной. Гибридный подход, комбинирующий разные модели в зависимости от контекста, показывает себя наиболее перспективным решением.

## Рекомендации по улучшению

### Краткосрочные
- ✅ Гибридный подход (реализовано)
- Ensemble методы (взвешенная комбинация моделей)
- Оптимизация гиперпараметров (Grid Search, Bayesian Optimization)

### Долгосрочные
- **Улучшение контентных фич**: Word2Vec, BERT для текстов
- **Deep Learning**: Neural Collaborative Filtering, Autoencoders, GNN
- **Дополнительные фичи**: демография, временные паттерны, контекст
- **Новые метрики**: Diversity, Novelty, Serendipity
- **Борьба со смещениями**: Debiasing методы, калибровка
- **A/B тестирование**: онлайн оценка на реальных пользователях

## Применимость в Production

### MVP (Этап 1)
- Гибридная модель (Popularity + Content + SVD)
- Batch обновления
- Простая инфраструктура

### Масштабирование (Этап 2)
- Deep Learning модели (NCF, Autoencoders)
- Online learning
- A/B тестирование

### Оптимизация (Этап 3)
- Мультимодальные подходы
- Reinforcement Learning
- Explainable AI

## Вычислительная сложность

| Модель | Обучение | Предсказание | Оптимизации |
|--------|----------|--------------|-------------|
| Popularity | O(n × m) | O(1) | Кэширование |
| Content-Based | O(n² × d) | O(n × d) | Разреженные матрицы, ANN |
| Item-Based CF | O(n² × m) | O(k × n) | Разреженные матрицы, инкрементальное обновление |
| SVD | O(k × n × m) | O(k) | GPU ускорение, mini-batch |

где:
- n = количество items (книг)
- m = количество users (пользователей)
- d = размерность TF-IDF векторов
- k = количество латентных факторов / соседей

## Структура кода

### Классы моделей
```python
PopularityRecommender       # Популярные книги
ContentBasedRecommender     # TF-IDF + косинусная близость
ItemBasedCF                 # Item-Based коллаборативная фильтрация
SVDRecommender              # Matrix Factorization
HybridRecommender           # Гибридная модель
```

### Функции оценки
```python
precision_at_k()            # Precision@K
recall_at_k()               # Recall@K
dcg_at_k()                  # DCG@K
ndcg_at_k()                 # nDCG@K
evaluate_model()            # Комплексная оценка модели
```

## Датасет: Goodbooks-10k

- **Размер**: ~10,000 книг, ~53,000 пользователей, ~6 млн оценок
- **Оценки**: шкала от 1 до 5
- **Дополнительно**: теги, авторы, названия, метаданные

## Автор и лицензия

Проект создан в образовательных целях для изучения рекомендательных систем.

## Полезные ссылки

- [Surprise Documentation](http://surpriselib.com/)
- [Scikit-learn TF-IDF](https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html)
- [RecSys Papers](https://paperswithcode.com/task/recommendation-systems)

---

**Примечание**: Для полного воспроизведения результатов требуется установка всех зависимостей и наличие датасета Goodbooks-10k.
