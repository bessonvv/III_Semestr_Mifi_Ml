# ะัะพะณะพะฒัะน ะฟัะพะตะบั: ะะธะฑัะธะดะฝะฐั ัะธััะตะผะฐ ัะตะบะพะผะตะฝะดะฐัะธะน ะบะฝะธะณ ั ะฝะตะนัะพัะตัะตะฒัะผะธ ะผะพะดะตะปัะผะธ

## ๐ ะะฟะธัะฐะฝะธะต ะฟัะพะตะบัะฐ

ะะฐะทัะฐะฑะพัะบะฐ ะบะพะผะฟะปะตะบัะฝะพะน ะณะธะฑัะธะดะฝะพะน ัะธััะตะผั ัะตะบะพะผะตะฝะดะฐัะธะน ะบะฝะธะณ, ะพะฑัะตะดะธะฝัััะตะน:
- โ ะะปะฐััะธัะตัะบะธะต ะผะตัะพะดั ะธะท ะดะพะผะฐัะฝะตะณะพ ะทะฐะดะฐะฝะธั (Popularity, Content-Based, Item-Based CF, SVD)
- ๐ ะกะพะฒัะตะผะตะฝะฝัะต ะฝะตะนัะพัะตัะตะฒัะต ะฐััะธัะตะบัััั
- ๐ ะะฝัะตะปะปะตะบััะฐะปัะฝัั ัััะฐัะตะณะธั ะพะฑัะตะดะธะฝะตะฝะธั ะผะพะดะตะปะตะน

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```
hw_1/
โโโ Final_Project_Hybrid_RecSys.ipynb  # ะัะฝะพะฒะฝะพะน ะฝะพััะฑัะบ ะฟัะพะตะบัะฐ
โโโ FINAL_PROJECT_README.md  # ะญัะพั ัะฐะนะป
โโโ data/  # ะะฐัะฐัะตั Goodbooks-10k
    โโโ ratings.csv
    โโโ books.csv
    โโโ tags.csv
    โโโ book_tags.csv
```

## ๐ ะกัััะบัััะฐ ะฝะพััะฑัะบะฐ

```
Final_Project_Hybrid_RecSys.ipynb
โ
โโโ 1. ะะะะะะะะ
โ   โโโ ะะฟะธัะฐะฝะธะต ะฟัะพะตะบัะฐ
โ   โโโ ะะผะฟะพัั ะฑะธะฑะปะธะพัะตะบ
โ
โโโ 2. ะะะะะฃะะะ ะะะะะะซะฅ ะะะะะะะ
โ   โโโ ะะฐะณััะทะบะฐ ะดะฐะฝะฝัั
โ   โโโ ะะฐะณััะทะบะฐ ะพะฑััะตะฝะฝัั ะผะพะดะตะปะตะน ะธะท ะะ
โ   โโโ ะะฐะทะพะฒัะต ะผะตััะธะบะธ ะผะพะดะตะปะตะน
โ
โโโ 3. FEATURE ENGINEERING
โ   โโโ 3.1 ะัะธะทะฝะฐะบะธ ะฟะพะปัะทะพะฒะฐัะตะปะตะน
โ   โโโ 3.2 ะัะธะทะฝะฐะบะธ ะบะฝะธะณ
โ   โโโ 3.3 ะัะธะทะฝะฐะบะธ ะฒะทะฐะธะผะพะดะตะนััะฒะธะน
โ
โโโ 4. ะะะะะะะะะฏ ะกะะกะขะะะ
โ   โโโ 4.1 ะะตะฝะตัะฐัะธั ะบะฐะฝะดะธะดะฐัะพะฒ
โ   โโโ 4.2 ะกะตะณะผะตะฝัะฐัะธั ะฟะพะปัะทะพะฒะฐัะตะปะตะน
โ   โโโ 4.3 ะกััะฐัะตะณะธั ะพะฑัะตะดะธะฝะตะฝะธั
โ   โโโ 4.4 ะคะธะฝะฐะปัะฝะพะต ัะฐะฝะถะธัะพะฒะฐะฝะธะต
โ
โโโ 5. ะะฆะะะะ ะะะะะะะะะ ะกะะกะขะะะซ
โ   โโโ 5.1 ะะตััะธะบะธ ะบะฐัะตััะฒะฐ
โ   โโโ 5.2 ะกัะฐะฒะฝะตะฝะธะต ั ะฑะฐะทะพะฒัะผะธ ะผะพะดะตะปัะผะธ
โ   โโโ 5.3 ะะฝะฐะปะธะท ะฟะพ ัะตะณะผะตะฝัะฐะผ
โ   โโโ 5.4 ะะธะทัะฐะปะธะทะฐัะธั ัะตะทัะปััะฐัะพะฒ
โ
โโโ 6. ะะะขะะะะะะฆะะฏ
โ   โโโ 6.1 ะะพะดะฑะพั ะฒะตัะพะฒ
โ   โโโ 6.2 A/B ัะตััะธัะพะฒะฐะฝะธะต
โ   โโโ 6.3 ะะฝะฐะปะธะท ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ
โ
โโโ 7. ะะะะะะกะะขะะะะ ะะะะฅะะ (ะะะฆะะะะะะฌะะ)
โ   โโโ 7.1 ะัะฑะพั ะฐััะธัะตะบัััั
โ   โโโ 7.2 ะะพะดะณะพัะพะฒะบะฐ ะดะฐะฝะฝัั
โ   โโโ 7.3 ะะฑััะตะฝะธะต ะผะพะดะตะปะธ
โ   โโโ 7.4 ะะฝัะตะณัะฐัะธั ะฒ ัะธััะตะผั
โ   โโโ 7.5 ะกัะฐะฒะฝะธัะตะปัะฝัะน ะฐะฝะฐะปะธะท
โ
โโโ 8. ะกะะะะะะะ ะะะะะะะะ (ะะะฆะะะะะะฌะะ)
โ   โโโ 8.1 ะะปะฐัั HybridRecommender
โ   โโโ 8.2 ะะฒัะพะผะฐัะธะทะฐัะธั ะพะฑััะตะฝะธั
โ   โโโ 8.3 API ะดะปั ัะตะบะพะผะตะฝะดะฐัะธะน
โ
โโโ 9. ะะซะะะะซ ะ ะะะะะะะะะะฆะะ
    โโโ ะัะพะณะพะฒะพะต ััะฐะฒะฝะตะฝะธะต
    โโโ ะัะตะธะผััะตััะฒะฐ ะธ ะฝะตะดะพััะฐัะบะธ
    โโโ ะะฐะฟัะฐะฒะปะตะฝะธั ัะปัััะตะฝะธั
```

## ๐ก ะะดะตะธ ะดะปั ะณะธะฑัะธะดะฝะพะน ัะธััะตะผั

### ะกััะฐัะตะณะธั 1: ะะทะฒะตัะตะฝะฝะพะต ัััะตะดะฝะตะฝะธะต
```python
hybrid_score = (
    w1 * popularity_score +
    w2 * content_score +
    w3 * item_cf_score +
    w4 * svd_score
)
```

### ะกััะฐัะตะณะธั 2: ะกะตะณะผะตะฝัะฐัะธั ะฟะพะปัะทะพะฒะฐัะตะปะตะน
- **ะะพะฒัะต ะฟะพะปัะทะพะฒะฐัะตะปะธ** (< 5 ะพัะตะฝะพะบ): Popularity + Content-Based
- **ะฃะผะตัะตะฝะฝัะต ะฟะพะปัะทะพะฒะฐัะตะปะธ** (5-50 ะพัะตะฝะพะบ): Item-CF + SVD
- **ะะบัะธะฒะฝัะต ะฟะพะปัะทะพะฒะฐัะตะปะธ** (> 50 ะพัะตะฝะพะบ): ะัะตะธะผััะตััะฒะตะฝะฝะพ SVD + Item-CF

### ะกััะฐัะตะณะธั 3: ะะฐัะบะฐะดะฝะฐั ัะธะปัััะฐัะธั
1. **ะญัะฐะฟ 1:** ะะตะฝะตัะฐัะธั ะบะฐะฝะดะธะดะฐัะพะฒ (100-200 ะบะฝะธะณ)
   - Popularity: ัะพะฟ-50
   - Content-Based: ัะพะฟ-50
   - Item-CF: ัะพะฟ-50
   - SVD: ัะพะฟ-50
2. **ะญัะฐะฟ 2:** ะะตัะตัะฐะฝะถะธัะพะฒะฐะฝะธะต ั ััะตัะพะผ ะฒัะตั ัะฐะบัะพัะพะฒ
3. **ะญัะฐะฟ 3:** ะคะธะปัััะฐัะธั ะธ ัะฐะทะฝะพะพะฑัะฐะทะธะต

## ๐ ะะตะพะฑัะพะดะธะผัะต ะฑะธะฑะปะธะพัะตะบะธ

```python
# ะะฐะทะพะฒัะต
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

# ML
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics.pairwise import cosine_similarity
from sklearn.decomposition import TruncatedSVD
from scipy.sparse import csr_matrix

# ะะตะนัะพัะตัะธ (ะพะฟัะธะพะฝะฐะปัะฝะพ)
import tensorflow as tf
from tensorflow import keras
from keras.layers import Input, Embedding, Flatten, Dense, Concatenate, Dot
from keras.models import Model

# ะฃัะธะปะธัั
from collections import defaultdict
import warnings
warnings.filterwarnings('ignore')
```

## ๐ฏ ะงะตะบ-ะปะธัั ะฒัะฟะพะปะฝะตะฝะธั

### ะะฐะทะพะฒะฐั ัะฐััั โ
- [ ] ะะฐะณััะทะบะฐ ะธ ะฟะพะดะณะพัะพะฒะบะฐ ะดะฐะฝะฝัั
- [ ] Feature Engineering (ะฟะพะปัะทะพะฒะฐัะตะปะธ, ะบะฝะธะณะธ, ะฒะทะฐะธะผะพะดะตะนััะฒะธั)
- [ ] ะะตะฐะปะธะทะฐัะธั ะณะธะฑัะธะดะฝะพะน ัะธััะตะผั
- [ ] ะะตะฝะตัะฐัะธั ะบะฐะฝะดะธะดะฐัะพะฒ ะพั ะฒัะตั ะผะพะดะตะปะตะน
- [ ] ะกััะฐัะตะณะธั ะพะฑัะตะดะธะฝะตะฝะธั ัะตะบะพะผะตะฝะดะฐัะธะน
- [ ] ะะฐััะตั ะผะตััะธะบ (Precision@K, Recall@K, nDCG@K)
- [ ] ะกัะฐะฒะฝะธัะตะปัะฝัะน ะฐะฝะฐะปะธะท ั ะฑะฐะทะพะฒัะผะธ ะผะพะดะตะปัะผะธ
- [ ] ะะธะทัะฐะปะธะทะฐัะธั ัะตะทัะปััะฐัะพะฒ
- [ ] ะะฟัะธะผะธะทะฐัะธั ะฒะตัะพะฒ
- [ ] ะัะฒะพะดั ะธ ัะตะบะพะผะตะฝะดะฐัะธะธ

### ะัะพะดะฒะธะฝััะฐั ัะฐััั ๐
- [ ] ะัะฑะพั ะฝะตะนัะพัะตัะตะฒะพะน ะฐััะธัะตะบัััั
- [ ] ะะพะดะณะพัะพะฒะบะฐ ะดะฐะฝะฝัั ะดะปั ะฝะตะนัะพัะตัะธ
- [ ] ะะตะฐะปะธะทะฐัะธั ะธ ะพะฑััะตะฝะธะต ะผะพะดะตะปะธ
- [ ] ะะฝัะตะณัะฐัะธั ะฒ ะณะธะฑัะธะดะฝัั ัะธััะตะผั
- [ ] ะกัะฐะฒะฝะธัะตะปัะฝัะน ะฐะฝะฐะปะธะท
- [ ] ะกะพะทะดะฐะฝะธะต ัะบะฒะพะทะฝะพะณะพ ะฟะฐะนะฟะปะฐะนะฝะฐ
- [ ] ะะฒัะพะผะฐัะธะทะฐัะธั ะฟัะพัะตััะฐ
- [ ] ะะพะบัะผะตะฝัะฐัะธั API

## ๐ ะะถะธะดะฐะตะผัะต ัะตะทัะปััะฐัั

### ะะตััะธะบะธ ะฑะฐะทะพะฒัั ะผะพะดะตะปะตะน (ะธะท ะะ):
- Popularity: Precision@10 ~ 0.001
- Content-Based: Precision@10 ~ 0.000
- Item-CF: Precision@10 ~ 0.005
- SVD: Precision@10 ~ 0.008

### ะฆะตะปะตะฒัะต ะผะตััะธะบะธ ะณะธะฑัะธะดะฝะพะน ัะธััะตะผั:
- **Precision@10:** > 0.010 (+25% ะพั ะปัััะตะน ะฑะฐะทะพะฒะพะน ะผะพะดะตะปะธ)
- **Recall@10:** > 0.025 (+25% ะพั ะปัััะตะน ะฑะฐะทะพะฒะพะน ะผะพะดะตะปะธ)
- **nDCG@10:** > 0.015 (+25% ะพั ะปัััะตะน ะฑะฐะทะพะฒะพะน ะผะพะดะตะปะธ)

### ะะพะฟะพะปะฝะธัะตะปัะฝัะต ะผะตััะธะบะธ:
- **Coverage:** ะะพะปั ัะตะบะพะผะตะฝะดะพะฒะฐะฝะฝัั ัะฝะธะบะฐะปัะฝัั ะบะฝะธะณ
- **Diversity:** ะะฐะทะฝะพะพะฑัะฐะทะธะต ะถะฐะฝัะพะฒ ะฒ ัะตะบะพะผะตะฝะดะฐัะธัั
- **Serendipity:** ะะตะพะถะธะดะฐะฝะฝัะต, ะฝะพ ัะตะปะตะฒะฐะฝัะฝัะต ัะตะบะพะผะตะฝะดะฐัะธะธ

## ๐ง ะะพะปะตะทะฝัะต ััะฝะบัะธะธ

### ะกะตะณะผะตะฝัะฐัะธั ะฟะพะปัะทะพะฒะฐัะตะปะตะน
```python
def segment_user(user_id, ratings_df):
    """ะะฟัะตะดะตะปะธัั ัะตะณะผะตะฝั ะฟะพะปัะทะพะฒะฐัะตะปั"""
    user_ratings_count = len(ratings_df[ratings_df['user_id'] == user_id])
    
    if user_ratings_count < 5:
        return 'new'
    elif user_ratings_count < 50:
        return 'moderate'
    else:
        return 'active'
```

### ะะตะฝะตัะฐัะธั ะบะฐะฝะดะธะดะฐัะพะฒ
```python
def generate_candidates(user_id, models, n_candidates=50):
    """ะกะณะตะฝะตัะธัะพะฒะฐัั ะบะฐะฝะดะธะดะฐัะพะฒ ะพั ะฒัะตั ะผะพะดะตะปะตะน"""
    candidates = {}
    
    for model_name, model in models.items():
        candidates[model_name] = model.recommend(user_id, n=n_candidates)
    
    return candidates
```

### ะคะธะฝะฐะปัะฝะพะต ัะฐะฝะถะธัะพะฒะฐะฝะธะต
```python
def hybrid_ranking(candidates, weights, user_segment):
    """ะคะธะฝะฐะปัะฝะพะต ัะฐะฝะถะธัะพะฒะฐะฝะธะต ั ััะตัะพะผ ัะตะณะผะตะฝัะฐ"""
    # ะะพััะตะบัะธัะพะฒะบะฐ ะฒะตัะพะฒ ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั ัะตะณะผะตะฝัะฐ
    adjusted_weights = adjust_weights(weights, user_segment)
    
    # ะะฑัะตะดะธะฝะตะฝะธะต ัะบะพัะพะฒ
    final_scores = {}
    for book_id in all_candidates:
        score = sum(
            adjusted_weights[model] * candidates[model].get(book_id, 0)
            for model in models
        )
        final_scores[book_id] = score
    
    return sorted(final_scores.items(), key=lambda x: x[1], reverse=True)
```


## ๐ ะัะธัะตัะธะธ ััะฟะตัะฐ

**ะัะปะธัะฝะพ (45-50 ะฑะฐะปะปะพะฒ):**
- ะะตะฐะปะธะทะพะฒะฐะฝั ะฒัะต ััะตะฑะพะฒะฐะฝะธั ะฑะฐะทะพะฒะพะน ะธ ะฟัะพะดะฒะธะฝััะพะน ัะฐััะธ
- ะะปัะฑะพะบะธะน ะฐะฝะฐะปะธะท ั ัะพะดะตัะถะฐัะตะปัะฝัะผะธ ะฒัะฒะพะดะฐะผะธ
- ะะตะนัะพัะตัะตะฒะฐั ะผะพะดะตะปั ะฟะพะบะฐะทัะฒะฐะตั ัะปัััะตะฝะธะต ะผะตััะธะบ
- ะงะธัััะน, ัะพัะพัะพ ะดะพะบัะผะตะฝัะธัะพะฒะฐะฝะฝัะน ะบะพะด
- ะะฝัะพัะผะฐัะธะฒะฝัะต ะฒะธะทัะฐะปะธะทะฐัะธะธ

**ะฅะพัะพัะพ (35-44 ะฑะฐะปะปะฐ):**
- ะะตะฐะปะธะทะพะฒะฐะฝะฐ ะฟะพะปะฝะฐั ะฑะฐะทะพะฒะฐั ัะฐััั
- ะงะฐััะธัะฝะฐั ัะตะฐะปะธะทะฐัะธั ะฟัะพะดะฒะธะฝััะพะน ัะฐััะธ
- ะะพััะตะบัะฝัะต ะผะตััะธะบะธ ะธ ััะฐะฒะฝะตะฝะธั
- ะะฐะทะพะฒัะต ะฒัะฒะพะดั

**ะฃะดะพะฒะปะตัะฒะพัะธัะตะปัะฝะพ (25-34 ะฑะฐะปะปะฐ):**
- ะะตะฐะปะธะทะพะฒะฐะฝะฐ ะฑะฐะทะพะฒะฐั ัะฐััั ั ะฝะตะดะพัะตัะฐะผะธ
- ะััั ััะฐะฒะฝะตะฝะธั, ะฝะพ ะฐะฝะฐะปะธะท ะฟะพะฒะตััะฝะพััะฝัะน
- ะะตััะธะบะธ ัะฐัััะธัะฐะฝั ะบะพััะตะบัะฝะพ
